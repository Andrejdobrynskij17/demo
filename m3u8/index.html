<!doctype html>
<html lang="en">
<head>
    <!-- <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
    <meta http-equiv="Cache-Control" content="max-age=604800" />
    <link rel="icon" href="../images/movie.ico">
    <title>DEMO</title>
    <link rel="canonical" href="https://bootstrap5.hexschool.com/docs/5.1/examples/offcanvas-navbar/"> -->

    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    <!-- <meta name="theme-color" content="#7952b3"> -->
<!-- 
    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
      .center {
        text-align: center;
        }
    </style> -->
   
</head>

  <body>
    <script>
      var urlParams;
      (window.onpopstate = function () {
        var match,
          pl     = /\+/g,  // Regex for replacing addition symbol with a space
          search = /([^&=]+)=?([^&]*)/g,
          decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
          query  = window.location.search.substring(1);
  
        urlParams = {};
        while (match = search.exec(query))
          urlParams[decode(match[1])] = decode(match[2]);
      })();
      // alert(urlParams["path"]);

      (async () => {
        let url = 'https://api.github.com/repos/pkj99/demo/contents/m3u8/' + urlParams["path"]
        // alert(url);
        const response = await fetch(url);
        const data = await response.json();
        let htmlString = '<ul>';
        
        for (let file of data) {
          // alert(file.path);
          if (file.name != "index.html") {
            if (file.type != "folder") {
              var newURL = window.location.protocol + "//" + window.location.host + "/" + window.location.pathname + window.location.search + file.name;
              htmlString += `<li><a href="${newURL}">${file.name}</a></li>`;
            }
            else {
              htmlString += `<li><a href="${file.download_url}">${file.name}</a></li>`;
            }
          }
        }

        htmlString += '</ul>';
        document.getElementsByTagName('body')[0].innerHTML = htmlString;
      })()
    </script>
  <body>
</html>